{% extends "coachreports/base.html" %}

{% load my_filters %}

{% block headjs %} {{ block.super }}
<!-- option 1: https://github.com/stringfellow/raphael-scatter -->
<!--script type="text/javascript" src="/static/js/jquery-1.7.1.min.js"></script-->
<script type="text/javascript" src="/static/js/raphael-min.js"></script>
<script type="text/javascript" src="/static/js/raphael.scatter.js"></script>
<script>
    var sp, sp2;

    window.onload = function () {
        var data1 = [],
            data2 = [];
        for (var dummy = 0; dummy <= 200; dummy++) {
            data1.push([Math.floor(Math.random()*101)/10, Math.floor(Math.random()*101)/10, {'text': 'point ' + dummy}]);
        }
        for (var dummy = 0; dummy <= 200; dummy++) {
            data2.push([Math.floor(Math.random()*101)/10, Math.floor(Math.random()*101)/10, {'text': dummy}]);
        }
/*
    scatterPlot.prototype.default_config = {
        size: SIZE,  // plot (i.e. plot area) height/width (square!)
        colours: [  // gradient colours
            ['#CF171F', 0],
            ['#F47721', 37.5],
            ['#FFC80B', 62.5],
            ['#C1D72E', 100]
        ],
        series_colours: ['#000', '#fff'],
        ticks: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],  //ticks.. obv.
        x_label: "",  // x axis label
        y_label: "",  // y axis label
        clickFn: scatterPlot.prototype.defaultClickFn,  // click a point and...
        hoverInFn: scatterPlot.prototype.defaultHoverInFn,  // click a point and...
        hoverOutFn: scatterPlot.prototype.defaultHoverOutFn  // click a point and...
    };
*/
        sp = new scatterPlot(
            {   x_label: "X LABEL", 
                "size": 600,
                colours: [  // gradient colours
                    ['#FFF', 0],
                    ['#fff', 37.5],
                    ['#fff', 62.5],
                    ['#fff', 100]
                ],
                series_colours: ['#f00', '#00f'],
        //        ticks: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],  //ticks.. obv.
                ticks: [0, 2, 4, 6, 8, 10],
            }, 
            "holder", {'I am a really long and annoying label': data1, 'DATA2': data2}
        );


        var loaderText = function (elem) {
            $('#loader').html(elem.data('text'));
        };
        sp2 = new scatterPlot({x_label: "X2 LABEL", clickFn: loaderText}, "holder2", []);
    };

    function testDots(count) {
        var data = [];
        for (var dummy = 0; dummy <= count; dummy++) {
            data.push([Math.floor(Math.random()*101)/10, Math.floor(Math.random()*101)/10, dummy]);
        }
        sp2.makeDots([data]); 
    }
</script>

<!-- option 2 -->
<script type="text/javascript" src="/static/js/google.jsapi.js"></script>

<script type="text/javascript">
//  google.load("visualization", "1", {packages:["corechart"]});
if (window['google'] != undefined && window['google']['loader'] != undefined) {
if (!window['google']['visualization']) {
window['google']['visualization'] = {};
google.visualization.Version = '1.0';
google.visualization.JSHash = '4c2447db544d51e9c1e1331ad8007df0';
google.visualization.LoadArgs = 'file\75visualization\46v\0751\46packages\75corechart';
}
google.loader.writeLoadTag("script", "/static/js/google.corechart.js", false);
}
</script>
<script type="text/javascript">
  google.setOnLoadCallback(drawChart);
      function drawChart() {

          var data = google.visualization.arrayToDataTable([
      ['{{ form.xaxis }}', '{{ form.yaxis }}'],
      {% for user, vals in data.data.items %}
      [{{ vals|get_item:form.xaxis }}, {{ vals|get_item:form.yaxis }}],
      {% endfor %}
    ]);

     var dataTable = new google.visualization.DataTable();
      dataTable.addColumn('number', '{{ form.xaxis }}');
      dataTable.addColumn('number', '{{ form.yaxis }}');
      // A column for custom tooltip content
//      dataTable.addColumn({type: 'string', role: 'tooltip'});
      dataTable.addColumn({'type': 'string', 'role': 'tooltip', 'p': {'html': true}});
      dataTable.addRows([
      {% for user, vals in data.data.items %}
      [{{ vals|get_item:form.xaxis }}, {{ vals|get_item:form.yaxis }}, '<div><a href=""><u><b>{{ data.users|get_item:user }}</b></u></a></div>'],
      {% endfor %}
      ]);
    var options = {
      title: '{{ form.xaxis }} vs. {{ form.yaxis }} comparison',
      hAxis: {title: '{{ form.xaxis }}', minValue: 0, maxValue: 1},
      vAxis: {title: '{{ form.yaxis }}', minValue: 0, maxValue: 50},
      legend: 'none',
      tooltip: { isHtml: 'true', trigger: 'selection' }
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));
    
/*//    chart.draw(data, options);
 chart.setAction({
      visible: function() { return true },
      enabled: function() { return true },
      id: 'sample',                  // An id is mandatory for all actions.
      text: 'See sample book',       // The text displayed in the tooltip.
      action: function() { 
      alert("1");
        }
    });
*/
        chart.draw(dataTable, options);
  }
</script>
{% endblock headjs %}


{% block headcss %} {{ block.super }}
<style>
#table div { margin-top: 25px; }
</style>
{% endblock headcss %}


{% block content %}
<div id="google">
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
</div>

<div id="raphael-scatter">
    <div id="holder"></div>
    <div id="holder2"></div>
    <div id="loader"></div>
    <button onclick="testDots($('#dotcount').val())";>Test</button><input id="dotcount" value="200"></input>
</div>

<div id="table">
    <div>
        <table>
            <tr>
                <th>users</th>
                <th>xaxis: {{ form.xaxis }}</th>
                <th>yaxis: {{ form.yaxis }}</th>
            </tr>
        {% for user, vals in data.data.items %}
            <tr>
                <td>{{ data.users|get_item:user }}</td>
                <td>{{ vals|get_item:form.xaxis }}</td>
                <td>{{ vals|get_item:form.yaxis }}</td>
            </tr>
        {% endfor %}
        </table>
    </div>

    <div id="raw">
    Form fields: <br/>
       {{ form }}
    </div>
    <div>
    Data blob: <br/>
        {{ data }}
    </div>
</div>
{% endblock content %}
