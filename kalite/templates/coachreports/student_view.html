{% extends "coachreports/base_google_visualization.html" %}

{% load repeatblock %}
{% load my_filters %}
{% load staticfiles %}
{% block coachreports_active %}{% endblock coachreports_active %}
{% block selfreports_active %}active{% endblock selfreports_active %}


{% block headjs %} {{ block.super }}
<script type="text/javascript" src="/static/js/coachreports/scatter_view.js"></script>
<!--script type="text/javascript" src="/static/js/coachreports/timeline_view.js"></script-->
{% endblock headjs %}

{% block headcss %} {{ block.super }}
<link rel='stylesheet' type='text/css' href='{% static "css/coachreports/scatter_view.css" %}'>
<!--link rel='stylesheet' type='text/css' href='{% static "css/coachreports/timeline_view.css" %}'-->
{% endblock headcss %}

{% block content %}
{% block navbar %}{{ block.super }}{% endblock navbar %}

<div id="scatter">
    <h1>Scatter plot</h1>

    <div id="choose">
        <form id="select_data" name="select_data">
        {% block axis_dropdown %}
            <select id="xaxis" name="xaxis">
                {% block data_options %}{{ block.super }}{% endblock %}
            </select>
            <select id="yaxis" name="yaxis">
                {% repeatblock data_options %}
            </select>
        {% endblock axis_dropdown %}
        </form>
    </div>

    <div id="google-chart">
    {% block chart_div %}
        <div id="loading"></div>
        <div id="scatter_div" class="google-chart"></div>
    {% endblock chart_div %}
    </div>
</div>


<script type="text/javascript">
{% mkrange 0 2 as axes_range %}
{% for ai in axes_range %}
    {% cycle "scatter_xaxis"  "scatter_yaxis"  as axis_value silent %}
    $("#{{ axis_value }}").change(function(){
        plotJsonData(
            "#scatter_div",
            "{% url api_data %}",
            "{{ form.topic_path }}", 
            $("#xaxis option:selected").val(),
            $("#yaxis option:selected").val()
        );
    });
{% endfor %}

    plotJsonData(
        "#scatter_div",
        "{% url api_data %}",
        "{{ form.topic_path }}", 
        "{{ form.xaxis }}", 
        "{{ form.yaxis }}"
    );
</script>
{% endblock content %}
